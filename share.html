<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>è³‡å®‰æƒ…è’ã€åˆ†æèˆ‡åˆ†äº«æ¸¬é©—</title>
<style>
body{font-family:"Microsoft JhengHei",sans-serif;background:#0f172a;color:#e5e7eb;padding:20px;}
h1,h2,h3{color:#38bdf8;}
.section{background:#020617;padding:15px;border-radius:8px;margin-bottom:20px;}
.question{margin-bottom:15px;}
input{padding:5px;margin:5px;}
button{background:#38bdf8;border:none;padding:10px 20px;font-size:16px;border-radius:6px;cursor:pointer;margin:5px;}
button:hover{background:#0ea5e9;}
button.danger{background:#ef4444;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{border:1px solid #334155;padding:8px;text-align:center;}
th{background:#1e293b;}
</style>
</head>
<body>

<h1>ğŸ›¡ï¸è³‡å®‰æƒ…è’ã€åˆ†æèˆ‡åˆ†äº«æ¸¬é©—ï¼ˆ20 é¡Œï¼‰</h1>

<div class="section">
  <h2>ğŸ‘¨â€ğŸ“ å­¸ç”Ÿè³‡æ–™</h2>
  ç­ç´šï¼š<input id="className">
  åº§è™Ÿï¼š<input id="no">
  å§“åï¼š<input id="name">
</div>

<div class="section" id="quiz"></div>
<button onclick="submitQuiz()">æäº¤æ¸¬é©—</button>
<h2 id="result"></h2>

<hr>

<div class="section" id="teacherLoginDiv">
  <h2>ğŸ” æ•™å¸«ç™»å…¥</h2>
  æ•™å¸«å¯†ç¢¼ï¼š<input type="password" id="teacherPwd">
  <button onclick="teacherLogin()">ç™»å…¥</button>
  <p id="loginMsg" style="color:#f87171"></p>
</div>

<div class="section" id="teacherArea" style="display:none">
  <h2>ğŸ‘¨â€ğŸ« æ•™å¸«æˆç¸¾ç¸½è¦½</h2>
  <button onclick="exportCSV()">ğŸ“¤ åŒ¯å‡º CSV</button>
  <button class="danger" onclick="clearRecords()">ğŸ—‘ æ¸…ç©ºæ‰€æœ‰æˆç¸¾</button>

  <table>
    <thead>
      <tr>
        <th>ç­ç´š</th><th>åº§è™Ÿ</th><th>å§“å</th><th>åˆ†æ•¸</th><th>æ™‚é–“</th>
      </tr>
    </thead>
    <tbody id="records"></tbody>
  </table>

  <button onclick="showAnswers()">ğŸ“¢ å…¬ä½ˆæ­£ç¢ºç­”æ¡ˆ</button>
  <div id="answerDiv" style="display:none">
    <h3>ğŸ“Œ æ­£ç¢ºç­”æ¡ˆè¡¨</h3>
    <table>
      <thead>
        <tr><th>é¡Œè™Ÿ</th><th>é¡Œç›®</th><th>æ­£ç¢ºç­”æ¡ˆ</th></tr>
      </thead>
      <tbody id="answerKey"></tbody>
    </table>
  </div>
</div>

<script>
const TEACHER_PASSWORD = "teacher123";

/* ===== é¡Œåº«ï¼šè³‡å®‰æƒ…è’ã€åˆ†æèˆ‡åˆ†äº«ï¼ˆ20 é¡Œï¼‰===== */
const questions = [
 {id:1,q:"è³‡å®‰æƒ…è’ï¼ˆCyber Threat Intelligence, CTIï¼‰çš„ä¸»è¦ç›®çš„ç‚ºä½•ï¼Ÿ",o:["æ”¶é›†å€‹äººéš±ç§","äº†è§£å¨è„…è¶¨å‹¢","æå‡ç¶²é€Ÿ","é™ä½ç¡¬é«”æˆæœ¬"],a:1},
 {id:2,q:"ä¸‹åˆ—ä½•è€…å±¬æ–¼é–‹æ”¾ä¾†æºæƒ…è’ï¼ˆOSINTï¼‰ï¼Ÿ",o:["å…§éƒ¨æ©Ÿå¯†æ–‡ä»¶","ä»˜è²»æš—ç¶²è³‡æ–™","å…¬é–‹ç¶²ç«™è³‡è¨Š","ç§äººèŠå¤©ç´€éŒ„"],a:2},
 {id:3,q:"è³‡å®‰æƒ…è’ä¸­ï¼ŒIOC é€šå¸¸ä»£è¡¨ä»€éº¼ï¼Ÿ",o:["å…¥ä¾µæŒ‡ä»¤","å¨è„…æŒ‡æ¨™","ä½œæ¥­ç³»çµ±","å…§éƒ¨æ§åˆ¶"],a:1},
 {id:4,q:"ä¸‹åˆ—å“ªä¸€é …å±¬æ–¼æŠ€è¡“å‹å¨è„…æƒ…è³‡ï¼Ÿ",o:["æ”»æ“Šè€…å‹•æ©Ÿ","æƒ¡æ„ IP ä½å€","æ”»æ“Šç­–ç•¥","æ³•è¦èªªæ˜"],a:1},
 {id:5,q:"è³‡å®‰æƒ…è’çš„è³‡æ–™ä¾†æºä¸åŒ…å«ä¸‹åˆ—å“ªä¸€é …ï¼Ÿ",o:["æ¼æ´å…¬å‘Š","ç¤¾ç¾¤åª’é«”","æ”»æ“Šå·¥å…·åˆ†æ","å€‹äººå¸³è™Ÿå¯†ç¢¼"],a:3},
 {id:6,q:"å°‡é›¶æ•£è³‡å®‰è³‡æ–™è½‰æ›ç‚ºå¯ç”¨è³‡è¨Šï¼Œå±¬æ–¼å“ªä¸€å€‹æ­¥é©Ÿï¼Ÿ",o:["è’é›†","åˆ†æ","åˆ†äº«","éŠ·æ¯€"],a:1},
 {id:7,q:"STIX èˆ‡ TAXII ä¸»è¦ç”¨æ–¼ï¼Ÿ",o:["è³‡æ–™åŠ å¯†","å¨è„…æƒ…è³‡äº¤æ›","èº«åˆ†é©—è­‰","å°åŒ…éæ¿¾"],a:1},
 {id:8,q:"ä¸‹åˆ—å“ªä¸€é …æœ€é©åˆç”¨æ–¼åˆ†äº«å¨è„…æƒ…è³‡ï¼Ÿ",o:["å£é ­è½‰è¿°","å³æ™‚é€šè¨Šæˆªåœ–","æ¨™æº–åŒ–æƒ…è³‡å¹³å°","æœªé©—è­‰æ¶ˆæ¯"],a:2},
 {id:9,q:"è³‡å®‰æƒ…è’ä¸­ï¼ŒTTPs æŒ‡çš„æ˜¯ï¼Ÿ",o:["å·¥å…·ã€æŠ€è¡“èˆ‡æµç¨‹","æ¸¬è©¦ã€è¿½è¹¤èˆ‡ä¿è­·","å¨è„…ã€è¶¨å‹¢èˆ‡æ”¿ç­–","æ™‚é–“ã€é¡å‹èˆ‡å¹³å°"],a:0},
 {id:10,q:"åˆ†æå‹’ç´¢è»Ÿé«”æ¨£æœ¬å±¬æ–¼å“ªä¸€é¡å‹æƒ…è’ï¼Ÿ",o:["ç­–ç•¥å‹","æˆ°è¡“å‹","æŠ€è¡“å‹","æ”¿ç­–å‹"],a:2},
 {id:11,q:"ç‚ºä½•è³‡å®‰æƒ…è³‡éœ€è¦å®šæœŸæ›´æ–°ï¼Ÿ",o:["ç¯€çœç©ºé–“","é¿å…è³‡æ–™éæ™‚","æå‡æ•ˆèƒ½","å¢åŠ æ•¸é‡"],a:1},
 {id:12,q:"ä¸‹åˆ—å“ªä¸€é …æ˜¯åˆ†äº«è³‡å®‰æƒ…è³‡æ™‚çš„é‡è¦åŸå‰‡ï¼Ÿ",o:["æœªç¶“æŸ¥è­‰å³åˆ†äº«","éµå®ˆéš±ç§èˆ‡æ³•è¦","åªåˆ†äº«çµ¦ç†Ÿäºº","å…¨éƒ¨å…¬é–‹"],a:1},
 {id:13,q:"è³‡å®‰æƒ…è’åˆ†æå¾Œæœ€é‡è¦çš„ç”¢å‡ºç‚ºä½•ï¼Ÿ",o:["å ±å‘Šæ–‡ä»¶","è¡Œå‹•å»ºè­°","åœ–è¡¨","è³‡æ–™åº«"],a:1},
 {id:14,q:"æƒ…è³‡å¯ä¿¡åº¦è©•ä¼°å¸¸ç”¨çš„æ¨™æº–ç‚ºï¼Ÿ",o:["ä¾†æºèˆ‡æº–ç¢ºæ€§","è³‡æ–™å¤§å°","åˆ†äº«é€Ÿåº¦","é¡è‰²åˆ†é¡"],a:0},
 {id:15,q:"ä¸‹åˆ—ä½•è€…å±¬æ–¼æƒ…è³‡åˆ†äº«çš„é¢¨éšªï¼Ÿ",o:["æå‡é˜²ç¦¦","èª¤å°æ±ºç­–","å¼·åŒ–åˆä½œ","æ¸›å°‘æ”»æ“Š"],a:1},
 {id:16,q:"è³‡å®‰æƒ…è’å¯å”åŠ©çµ„ç¹”é”æˆä¸‹åˆ—ä½•è€…ï¼Ÿ",o:["æå‰é˜²ç¦¦","å®Œå…¨å…ç–«","å–ä»£é˜²ç«ç‰†","é¿å…æ›´æ–°"],a:0},
 {id:17,q:"åœ¨æƒ…è³‡åˆ†æä¸­ï¼Œäº¤å‰æ¯”å°å¤šä¾†æºè³‡æ–™çš„ç›®çš„ç‚ºä½•ï¼Ÿ",o:["å¢åŠ æ•¸é‡","æå‡å¯ä¿¡åº¦","ç¯€çœæ™‚é–“","é™ä½æˆæœ¬"],a:1},
 {id:18,q:"ä¸‹åˆ—å“ªä¸€é …æœ€ä¸é©åˆç›´æ¥ä½œç‚ºå¨è„…æƒ…è³‡ï¼Ÿ",o:["æœªè­‰å¯¦å‚³è¨€","å®˜æ–¹æ¼æ´å…¬å‘Š","æƒ¡æ„é›œæ¹Šå€¼","æ”»æ“Šæ¨£æœ¬"],a:0},
 {id:19,q:"è³‡å®‰æƒ…è³‡åˆ†äº«å°æ•´é«”é˜²ç¦¦çš„æœ€å¤§å¹«åŠ©ç‚ºä½•ï¼Ÿ",o:["å€‹åˆ¥é˜²è­·","å¿«é€Ÿæ‡‰è®Š","éš±è—é¢¨éšª","å¢åŠ è¤‡é›œåº¦"],a:1},
 {id:20,q:"è³‡å®‰æƒ…è’ã€åˆ†æèˆ‡åˆ†äº«çš„æœ€çµ‚ç›®æ¨™ç‚ºï¼Ÿ",o:["æ”¶é›†è³‡æ–™","å¼·åŒ–æ±ºç­–èˆ‡é˜²ç¦¦èƒ½åŠ›","å¢åŠ å ±å‘Šæ•¸é‡","æŠ€è¡“å±•ç¤º"],a:1}
];

let currentQuestions = [];

/* ===== è¼‰å…¥é¡Œç›®ï¼ˆéš¨æ©Ÿï¼‰===== */
window.onload = function(){
  currentQuestions = [...questions].sort(()=>Math.random()-0.5);
  const quiz = document.getElementById("quiz");
  quiz.innerHTML = "";
  currentQuestions.forEach((q,i)=>{
    let html = `<div class="question"><b>${i+1}. ${q.q}</b><br>`;
    q.o.forEach((o,j)=>{
      html += `<label><input type="radio" name="q${i}" value="${j}"> ${o}</label><br>`;
    });
    html += "</div>";
    quiz.innerHTML += html;
  });
}

/* ===== å­¸ç”Ÿæäº¤ ===== */
function submitQuiz(){
  const c = className.value;
  const n = no.value;
  const nm = name.value;
  if(!c || !n || !nm){
    alert("è«‹å¡«å®Œæ•´å­¸ç”Ÿè³‡æ–™");
    return;
  }

  let score = 0;
  currentQuestions.forEach((q,i)=>{
    const s = document.querySelector(`input[name="q${i}"]:checked`);
    if(s && +s.value === q.a) score++;
  });

  result.innerText = `ä½ çš„æˆç¸¾ï¼š${score} / 20`;

  const data = JSON.parse(localStorage.getItem("records") || "[]");
  data.push({class:c,no:n,name:nm,score,time:new Date().toLocaleString()});
  localStorage.setItem("records", JSON.stringify(data));
  loadRecords();
}

/* ===== æ•™å¸«ç™»å…¥ ===== */
function teacherLogin(){
  if(teacherPwd.value === TEACHER_PASSWORD){
    teacherLoginDiv.style.display="none";
    teacherArea.style.display="block";
    loadRecords();
  }else{
    loginMsg.innerText="âŒ å¯†ç¢¼éŒ¯èª¤";
  }
}

/* ===== é¡¯ç¤ºæˆç¸¾ ===== */
function loadRecords(){
  records.innerHTML = "";
  const data = JSON.parse(localStorage.getItem("records") || "[]");
  data.forEach(r=>{
    records.innerHTML += `<tr>
      <td>${r.class}</td>
      <td>${r.no}</td>
      <td>${r.name}</td>
      <td>${r.score}</td>
      <td>${r.time}</td>
    </tr>`;
  });
}

/* ===== æ¸…ç©ºæˆç¸¾ ===== */
function clearRecords(){
  if(confirm("ç¢ºå®šæ¸…ç©ºæ‰€æœ‰å­¸ç”Ÿæˆç¸¾ï¼Ÿ")){
    localStorage.removeItem("records");
    loadRecords();
    alert("âœ… æˆç¸¾å·²æ¸…ç©º");
  }
}

/* ===== å…¬ä½ˆç­”æ¡ˆ ===== */
function showAnswers(){
  answerDiv.style.display="block";
  answerKey.innerHTML="";
  questions.forEach(q=>{
    answerKey.innerHTML += `<tr>
      <td>${q.id}</td>
      <td>${q.q}</td>
      <td>${q.o[q.a]}</td>
    </tr>`;
  });
}

/* ===== CSV åŒ¯å‡ºï¼ˆUTF-8 + BOMï¼ŒExcel ä¸äº‚ç¢¼ï¼‰===== */
function exportCSV(){
  const data = JSON.parse(localStorage.getItem("records") || "[]");
  if(!data.length){
    alert("ç›®å‰æ²’æœ‰æˆç¸¾å¯åŒ¯å‡º");
    return;
  }

  let csv = "ç­ç´š,åº§è™Ÿ,å§“å,åˆ†æ•¸,æ™‚é–“\n";
  data.forEach(r=>{
    csv += `"${r.class}","${r.no}","${r.name}","${r.score}","${r.time}"\n`;
  });

  const BOM = "\uFEFF"; // â˜… é—œéµ
  const blob = new Blob(
    [BOM + csv],
    { type: "text/csv;charset=utf-8;" }
  );

  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "è³‡é€šå®‰å…¨æ¸¬é©—æˆç¸¾.csv";
  a.click();
}
</script>

</body>
</html>
